{
  "version": "6.2",
  "data_api_version": "3.0",
  "routing_model": {
    "ESPECIALIDADE": ["TIPO_ATENDIMENTO"],
    "TIPO_ATENDIMENTO": ["INFO_CONVENIO"],
    "INFO_CONVENIO": ["DADOS_PACIENTE"]
  },
  "screens": [
    {
      "id": "ESPECIALIDADE",
      "title": "Agendar Consulta",
      "data": {
        "especialidades": {
          "type": "array",
          "items": {
            "type": "object",
            "properties": {
              "id": {"type": "string"},
              "title": {"type": "string"},
              "description": {"type": "string"}
            }
          },
          "__example__": [
            {"id": "derma_clinica", "title": "Dermatologia Clínica", "description": "Dr. Ricardo Mendes"}
          ]
        },
        "error_message": {
          "type": "string",
          "__example__": ""
        }
      },
      "layout": {
        "type": "SingleColumnLayout",
        "children": [
          {
            "type": "TextBody",
            "text": "Qual especialidade você precisa?"
          },
          {
            "type": "Form",
            "name": "form_especialidade",
            "children": [
              {
                "type": "RadioButtonsGroup",
                "name": "especialidade",
                "label": "Especialidade",
                "required": true,
                "data-source": "${data.especialidades}"
              },
              {
                "type": "Footer",
                "label": "Continuar",
                "on-click-action": {
                  "name": "data_exchange",
                  "payload": {
                    "especialidade": "${form.especialidade}"
                  }
                }
              }
            ]
          }
        ]
      }
    },
    {
      "id": "TIPO_ATENDIMENTO",
      "title": "Tipo de Atendimento",
      "data": {
        "especialidade": {
          "type": "string",
          "__example__": "derma_clinica"
        },
        "professional_id": {
          "type": "string",
          "__example__": "prof123"
        },
        "professional_name": {
          "type": "string",
          "__example__": "Dr. Ricardo Mendes"
        },
        "specialty_name": {
          "type": "string",
          "__example__": "Dermatologia Clínica"
        },
        "tipos_pagamento": {
          "type": "array",
          "items": {
            "type": "object",
            "properties": {
              "id": {"type": "string"},
              "title": {"type": "string"},
              "description": {"type": "string"}
            }
          },
          "__example__": [
            {"id": "convenio", "title": "Convênio", "description": "Tenho plano de saúde"},
            {"id": "particular", "title": "Particular", "description": "Pagamento direto"}
          ]
        },
        "error_message": {
          "type": "string",
          "__example__": ""
        }
      },
      "layout": {
        "type": "SingleColumnLayout",
        "children": [
          {
            "type": "TextBody",
            "text": "Como será o pagamento da consulta?"
          },
          {
            "type": "Form",
            "name": "form_pagamento",
            "children": [
              {
                "type": "RadioButtonsGroup",
                "name": "tipo_pagamento",
                "label": "Tipo de atendimento",
                "required": true,
                "data-source": "${data.tipos_pagamento}"
              },
              {
                "type": "Footer",
                "label": "Continuar",
                "on-click-action": {
                  "name": "data_exchange",
                  "payload": {
                    "especialidade": "${data.especialidade}",
                    "professional_id": "${data.professional_id}",
                    "professional_name": "${data.professional_name}",
                    "specialty_name": "${data.specialty_name}",
                    "tipo_pagamento": "${form.tipo_pagamento}"
                  }
                }
              }
            ]
          }
        ]
      }
    },
    {
      "id": "INFO_CONVENIO",
      "title": "Dados do Convênio",
      "data": {
        "especialidade": {
          "type": "string",
          "__example__": "derma_clinica"
        },
        "professional_id": {
          "type": "string",
          "__example__": "prof123"
        },
        "professional_name": {
          "type": "string",
          "__example__": "Dr. Ricardo Mendes"
        },
        "specialty_name": {
          "type": "string",
          "__example__": "Dermatologia Clínica"
        },
        "tipo_pagamento": {
          "type": "string",
          "__example__": "convenio"
        },
        "convenios": {
          "type": "array",
          "items": {
            "type": "object",
            "properties": {
              "id": {"type": "string"},
              "title": {"type": "string"}
            }
          },
          "__example__": [
            {"id": "unimed", "title": "Unimed"},
            {"id": "bradesco_saude", "title": "Bradesco Saúde"}
          ]
        },
        "show_convenio_fields": {
          "type": "boolean",
          "__example__": true
        },
        "error_message": {
          "type": "string",
          "__example__": ""
        }
      },
      "layout": {
        "type": "SingleColumnLayout",
        "children": [
          {
            "type": "TextBody",
            "text": "Se for particular, pode pular esta etapa."
          },
          {
            "type": "Form",
            "name": "form_convenio",
            "children": [
              {
                "type": "Dropdown",
                "name": "convenio_nome",
                "label": "Seu convênio",
                "required": false,
                "data-source": "${data.convenios}"
              },
              {
                "type": "TextInput",
                "name": "convenio_numero",
                "label": "Nº da carteirinha",
                "input-type": "text",
                "required": false,
                "helper-text": "Encontre no cartão do convênio"
              },
              {
                "type": "Footer",
                "label": "Continuar",
                "on-click-action": {
                  "name": "data_exchange",
                  "payload": {
                    "especialidade": "${data.especialidade}",
                    "professional_id": "${data.professional_id}",
                    "professional_name": "${data.professional_name}",
                    "specialty_name": "${data.specialty_name}",
                    "tipo_pagamento": "${data.tipo_pagamento}",
                    "convenio_nome": "${form.convenio_nome}",
                    "convenio_numero": "${form.convenio_numero}"
                  }
                }
              }
            ]
          }
        ]
      }
    },
    {
      "id": "DADOS_PACIENTE",
      "title": "Dados do Paciente",
      "terminal": true,
      "data": {
        "especialidade": {
          "type": "string",
          "__example__": "derma_clinica"
        },
        "professional_id": {
          "type": "string",
          "__example__": "prof123"
        },
        "professional_name": {
          "type": "string",
          "__example__": "Dr. Ricardo Mendes"
        },
        "specialty_name": {
          "type": "string",
          "__example__": "Dermatologia Clínica"
        },
        "tipo_pagamento": {
          "type": "string",
          "__example__": "convenio"
        },
        "convenio_nome": {
          "type": "string",
          "__example__": "unimed"
        },
        "convenio_numero": {
          "type": "string",
          "__example__": "123456789"
        },
        "error_message": {
          "type": "string",
          "__example__": ""
        }
      },
      "layout": {
        "type": "SingleColumnLayout",
        "children": [
          {
            "type": "TextBody",
            "text": "Preencha seus dados para o agendamento."
          },
          {
            "type": "Form",
            "name": "form_paciente",
            "children": [
              {
                "type": "TextInput",
                "name": "nome",
                "label": "Nome completo",
                "input-type": "text",
                "required": true,
                "helper-text": "Como consta no documento"
              },
              {
                "type": "TextInput",
                "name": "cpf",
                "label": "CPF",
                "input-type": "text",
                "required": true,
                "helper-text": "Ex: 123.456.789-00"
              },
              {
                "type": "DatePicker",
                "name": "data_nascimento",
                "label": "Data de nascimento",
                "required": true,
                "max-date": "2025-12-31",
                "helper-text": "Selecione sua data de nascimento"
              },
              {
                "type": "Footer",
                "label": "Ver Horários",
                "on-click-action": {
                  "name": "complete",
                  "payload": {
                    "professional_id": "${data.professional_id}",
                    "professional_name": "${data.professional_name}",
                    "specialty_name": "${data.specialty_name}",
                    "tipo_pagamento": "${data.tipo_pagamento}",
                    "convenio_nome": "${data.convenio_nome}",
                    "convenio_numero": "${data.convenio_numero}",
                    "nome": "${form.nome}",
                    "cpf": "${form.cpf}",
                    "data_nascimento": "${form.data_nascimento}"
                  }
                }
              }
            ]
          }
        ]
      }
    }
  ]
}
