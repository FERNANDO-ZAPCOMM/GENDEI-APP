{
  "openapi": "3.0.0",
  "info": { "title": "Gendei Reminder System API", "version": "2.0.0" },
  "paths": {
    "/reminders/trigger": {
      "post": {
        "summary": "Trigger Scheduled Reminders",
        "description": "Cloud Scheduler entry point. Processes 24h and 2h reminders for all confirmed appointments in the current time windows.",
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "type": "object",
                "properties": {
                  "source": { "type": "string", "description": "Trigger source identifier (e.g. 'cloud-scheduler', 'manual')" }
                }
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "Reminder processing result",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "success": { "type": "boolean" },
                    "result": { "$ref": "#/components/schemas/ReminderResult" },
                    "timestamp": { "type": "string", "format": "date-time" }
                  }
                }
              }
            }
          }
        }
      }
    },
    "/reminders/send/{appointmentId}": {
      "post": {
        "summary": "Send Single Reminder",
        "description": "Manually send a reminder for a specific appointment. Useful for testing or re-sending.",
        "parameters": [
          { "name": "appointmentId", "in": "path", "required": true, "schema": { "type": "string" } }
        ],
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "type": "object",
                "properties": {
                  "type": { "type": "string", "enum": ["24h", "2h"], "default": "24h" }
                }
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "Reminder sent successfully",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "success": { "type": "boolean" },
                    "message": { "type": "string" }
                  }
                }
              }
            }
          },
          "404": {
            "description": "Appointment not found or send failed",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "success": { "type": "boolean", "enum": [false] },
                    "error": { "type": "string" }
                  }
                }
              }
            }
          }
        }
      }
    }
  },
  "components": {
    "schemas": {
      "ReminderResult": {
        "type": "object",
        "properties": {
          "sent24h": { "type": "integer", "description": "Number of 24h reminders sent" },
          "sent2h": { "type": "integer", "description": "Number of 2h reminders sent" },
          "errors": { "type": "integer", "description": "Number of send failures" }
        }
      }
    }
  }
}
